# AWS Integration

This integration is used to fetches logs and metrics from 
[Amazon Web Services](https://aws.amazon.com/).

## Logs

### cloudtrail

The `cloudtrail` dataset collects the AWS CloudTrail logs. CloudTrail monitors 
events for the account. If user creates a trail, it delivers those events as log
 files to a specific Amazon S3 bucket. The `cloudtrail` dataset does not read 
 the CloudTrail Digest files that are delivered to the S3 bucket when Log File 
 Integrity is turned on, it only reads the CloudTrail logs.

**Exported fields**

| Field | Description | Type |
|---|---|---|
| event_version | The CloudTrail version of the log event format. | keyword |
| user_identity.type | The type of the identity. | keyword |
| user_identity.arn | The Amazon Resource Name (ARN) of the principal that made the call. | keyword |
| user_identity.access_key_id | The access key ID that was used to sign the request. | keyword |
| user_identity.session_context.mfa_authenticated | The value is true if the root user or IAM user whose credentials were used for the request also was authenticated with an MFA device; otherwise, false. | keyword|
| user_identity.session_context.creation_date | The date and time when the temporary security credentials were issued | date|
| user_identity.invoked_by | The name of the AWS service that made the request, such as Amazon EC2 Auto Scaling or AWS Elastic Beanstalk. | keyword |
| user_identity.session_issuer.type | The source of the temporary security credentials, such as Root, IAMUser, or Role. | keyword |
| user_identity.session_issuer.principal_id | The internal ID of the entity that was used to get credentials. | keyword |
| user_identity.session_issuer.arn | The ARN of the source (account, IAM user, or role) that was used to get temporary security credentials. | keyword |
| user_identity.session_issuer.account_id | The account that owns the entity that was used to get credentials | keyword |
| error_code | The AWS service error if the request returns an error. | keyword |
| error_message | If the request returns an error, the description of the error. | keyword |
| request_parameters | The parameters, if any, that were sent with the request. | keyword |
| response_elements | The response element for actions that make changes (create, update, or delete actions). | keyword |
| additional_eventdata | Additional data about the event that was not part of the request or response. | keyword |
| request_id | The value that identifies the request. The service being called generates this value. | keyword |
| event_type | Identifies the type of event that generated the event record. | keyword |
| api_version | Identifies the API version associated with the AwsApiCall eventType value. | keyword |
| management_event | A Boolean value that identifies whether the event is a management event. | keyword |
| read_only | Identifies whether this operation is a read-only operation. | keyword | 
| resources.arn | Resource ARNs. | keyword | 
| resources.account_id | Account ID of the resource owner. | keyword | 
| resources.type | Resource type identifier in the format: `AWS::aws-service-name::data-type-name`. | keyword | 
| recipient_account_id | Represents the account ID that received this event. | keyword | 
| service_event_details | Identifies the service event, including what triggered the event and the result. | keyword | 
| shared_event_id | GUID generated by CloudTrail to uniquely identify CloudTrail events from the same AWS action that is sent to different AWS accounts. | keyword | 
| vpc_endpoint_id | Identifies the VPC endpoint in which requests were made from a VPC to another AWS service, such as Amazon S3. | keyword | 
| console_login.additional_eventdata | Identifies whether ConsoleLogin was from mobile version.  | boolean | 
| console_login.login_to | URL for ConsoleLogin. | keyword | 
| console_login.mfa_used | Identifies whether multi factor authentication was used during ConsoleLogin | boolean |

### cloudwatch

The `cloudwatch` dataset collects CloudWatch logs. Users can use Amazon 
CloudWatch logs to monitor, store, and access log files from different sources. 
Export logs from log groups to an Amazon S3 bucket which has SQS notification 
setup already.

**Exported fields**

| Field | Description | Type |
|---|---|---|
| message | cloudwatch log message | text | 

### ec2

The `ec2` dataset is specifically for EC2 logs stored in AWS CloudWatch. Export logs
from log groups to Amazon S3 bucket which has SQS notification setup already.
With this dataset, EC2 logs will be parsed into fields like  `ip_address`
and `process.name`. For logs from other services, please use `cloudwatch` dataset.


**Exported fields**

| Field | Description | Type |
|---|---|---|
| ip_address | The internet address of the requester. | keyword | 
| process.name | Process name. | keyword|
| message | cloudwatch EC2 log message | text | 

### elb

The `elb` dataset collects logs from AWS ELBs. Elastic Load Balancing provides 
access logs that capture detailed information about requests sent to the load 
balancer. Each log contains information such as the time the request was 
received, the client's IP address, latencies, request paths, and server 
responses. Users can use these access logs to analyze traffic patterns and to 
troubleshoot issues.

Please follow [enable access logs for classic load balancer](https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-access-logs.html)
for sending Classic ELB access logs to S3 bucket.
For application load balancer, please follow [enable access log for application load balancer](https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-access-logs.html#enable-access-logging).
For network load balancer, please follow [enable access log for network load balancer](https://docs.aws.amazon.com/elasticloadbalancing/latest//network/load-balancer-access-logs.html).

**Exported fields**

| Field | Description | Type |
|---|---|---|
| name | The name of the load balancer. | keyword | 
| type | The type of the load balancer for v2 Load Balancers. | keyword | 
| target_group.arn | The ARN of the target group handling the request. | keyword | 
| listener | The ELB listener that received the connection. | keyword | 
| protocol | The protocol of the load balancer (http or tcp). | keyword | 
| request_processing_time.sec | The total time in seconds since the connection or request is received until it is sent to a registered backend. | float | 
| backend_processing_time.sec | The total time in seconds since the connection is sent to the backend till the backend starts responding. | float | 
| response_processing_time.sec | The total time in seconds since the response is received from the backend till it is sent to the client. | float | 
| connection_time.ms | The total time of the connection in milliseconds, since it is opened till it is closed. | long | 
| tls_handshake_time.ms | The total time for the TLS handshake to complete in milliseconds once the connection has been established. | long | 
| backend.ip | The IP address of the backend processing this connection. | keyword |
| backend.port | The port in the backend processing this connection. | keyword | 
| backend.http.response.status_code  | The status code from the backend (status code sent to the client from ELB is stored in `http.response.status_code`. | keyword | 
| ssl_cipher | The SSL cipher used in TLS/SSL connections. | keyword | 
| ssl_protocol | The SSL protocol used in TLS/SSL connections. | keyword | 
| chosen_cert.arn | The ARN of the chosen certificate presented to the client in TLS/SSL connections.  | keyword | 
| chosen_cert.serial | The serial number of the chosen certificate presented to the client in TLS/SSL connections. | keyword | 
| incoming_tls_alert | The integer value of TLS alerts received by the load balancer from the client, if present. | keyword | 
| tls_named_group | The TLS named group. | keyword | 
| trace_id | The contents of the `X-Amzn-Trace-Id` header. | keyword | 
| matched_rule_priority | The priority value of the rule that matched the request, if a rule matched. | keyword | 
| action_executed | The action executed when processing the request (forward, fixed-response, authenticate...). It can contain several values. | keyword | 
| redirect_url | The URL used if a redirection action was executed. | keyword | 
| error.reason | The error reason if the executed action failed. | keyword | 

### s3access

The `s3access` dataset collects server access logs from AWS S3. Server access 
logging provides detailed records for the requests that are made to a bucket. 
Server access logs are useful for many applications. For example, access log 
information can be useful in security and access audits. It can also help users
to learn about customer base and understand Amazon S3 bill.

Please follow [how to enable server access logging](https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html#server-access-logging-overview)
for sending server access logs to S3 bucket.

**Exported fields**

| Field | Description | Type |
|---|---|---|
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 

### vpcflow

**Exported fields**

| Field | Description | Type |
|---|---|---|
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 
|  |  | keyword | 

## Metrics

### billing

An example event for `billing` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### cloudwatch

An example event for `cloudwatch` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### dynamodb

An example event for `dynamodb` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### ebs

An example event for `ebs` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### ec2

An example event for `ec2` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### elb

An example event for `elb` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### lambda

An example event for `lambda` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### natgateway

An example event for `natgateway` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### rds

An example event for `rds` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### s3_daily_storage

An example event for `s3_daily_storage` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### s3_request

An example event for `s3_request` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### sns

An example event for `sns` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### sqs

An example event for `sqs` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### transitgateway

An example event for `transitgateway` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### usage

An example event for `usage` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|

### vpn

An example event for `vpn` looks as following:

```$json

```

**Exported fields**

| Field | Description | Type |
|---|---|---|
