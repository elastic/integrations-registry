- default_field: false
  description: |
    Fields exported by the Zeek smb_cmd log.
  fields:
  - description: |
      The command sent by the client.
    name: command
    type: keyword
  - description: |
      The subcommand sent by the client, if present.
    name: sub_command
    type: keyword
  - description: |
      Command argument sent by the client, if any.
    name: argument
    type: keyword
  - description: |
      Server reply to the client's command.
    name: status
    type: keyword
  - description: |
      Round trip time from the request to the response.
    name: rtt
    type: double
  - description: |
      Version of SMB for the command.
    name: version
    type: keyword
  - description: |
      Authenticated username, if available.
    name: username
    type: keyword
  - description: |
      If this is related to a tree, this is the tree that was used for the current command.
    name: tree
    type: keyword
  - description: |
      The type of tree (disk share, printer share, named pipe, etc.).
    name: tree_service
    type: keyword
  - description: |
      If the command referenced a file, store it here.
    fields:
    - description: |
        Filename if one was seen.
      name: name
      type: keyword
    - description: |
        Action this log record represents.
      name: action
      type: keyword
    - description: |
        UID of the referenced file.
      name: uid
      type: keyword
    - fields:
      - description: |
          Address of the transmitting host.
        name: tx
        type: ip
      - description: |
          Address of the receiving host.
        name: rx
        type: ip
      name: host
      type: group
    name: file
    type: group
  - description: |
      Present if base/protocols/smb/smb1-main.bro is loaded.
      Dialects offered by the client.
    name: smb1_offered_dialects
    type: keyword
  - description: |
      Present if base/protocols/smb/smb2-main.bro is loaded.
      Dialects offered by the client.
    name: smb2_offered_dialects
    type: integer
  name: zeek.smb_cmd
  type: group
