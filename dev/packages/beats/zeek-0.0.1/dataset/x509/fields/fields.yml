- default_field: false
  description: |
    Fields exported by the Zeek x509 log.
  fields:
  - description: |
      File id of this certificate.
    name: id
    type: keyword
  - description: |
      Basic information about the certificate.
    fields:
    - description: |
        Version number.
      name: version
      type: integer
    - description: |
        Serial number.
      name: serial
      type: keyword
    - description: |
        Subject.
      fields:
      - description: |
          Country provided in the certificate subject.
        name: country
        type: keyword
      - description: |
          Common name provided in the certificate subject.
        name: common_name
        type: keyword
      - description: |
          Locality provided in the certificate subject.
        name: locality
        type: keyword
      - description: |
          Organization provided in the certificate subject.
        name: organization
        type: keyword
      - description: |
          Organizational unit provided in the certificate subject.
        name: organizational_unit
        type: keyword
      - description: |
          State or province provided in the certificate subject.
        name: state
        type: keyword
      name: subject
      type: group
    - description: |
        Issuer.
      fields:
      - description: |
          Country provided in the certificate issuer field.
        name: country
        type: keyword
      - description: |
          Common name provided in the certificate issuer field.
        name: common_name
        type: keyword
      - description: |
          Locality provided in the certificate issuer field.
        name: locality
        type: keyword
      - description: |
          Organization provided in the certificate issuer field.
        name: organization
        type: keyword
      - description: |
          Organizational unit provided in the certificate issuer field.
        name: organizational_unit
        type: keyword
      - description: |
          State or province provided in the certificate issuer field.
        name: state
        type: keyword
      name: issuer
      type: group
    - description: |
        Last (most specific) common name.
      name: common_name
      type: keyword
    - description: |
        Certificate validity timestamps
      fields:
      - description: |
          Timestamp before when certificate is not valid.
        name: from
        type: date
      - description: |
          Timestamp after when certificate is not valid.
        name: until
        type: date
      name: valid
      type: group
    - fields:
      - description: |
          Name of the key algorithm.
        name: algorithm
        type: keyword
      - description: |
          Key type, if key parseable by openssl (either rsa, dsa or ec).
        name: type
        type: keyword
      - description: |
          Key length in bits.
        name: length
        type: integer
      name: key
      type: group
    - description: |
        Name of the signature algorithm.
      name: signature_algorithm
      type: keyword
    - description: |
        Exponent, if RSA-certificate.
      name: exponent
      type: keyword
    - description: |
        Curve, if EC-certificate.
      name: curve
      type: keyword
    name: certificate
    type: group
  - description: |
      Subject alternative name extension of the certificate.
    fields:
    - description: |
        List of DNS entries in SAN.
      name: dns
      type: keyword
    - description: |
        List of URI entries in SAN.
      name: uri
      type: keyword
    - description: |
        List of email entries in SAN.
      name: email
      type: keyword
    - description: |
        List of IP entries in SAN.
      name: ip
      type: ip
    - description: |
        True if the certificate contained other, not recognized or parsed name fields.
      name: other_fields
      type: boolean
    name: san
    type: group
  - description: |
      Basic constraints extension of the certificate.
    fields:
    - description: |
        CA flag set or not.
      name: certificate_authority
      type: boolean
    - description: |
        Maximum path length.
      name: path_length
      type: integer
    name: basic_constraints
    type: group
  - description: |
      Present if policy/protocols/ssl/log-hostcerts-only.bro is loaded
      Logging of certificate is suppressed if set to F.
    name: log_cert
    type: boolean
  name: zeek.x509
  type: group
