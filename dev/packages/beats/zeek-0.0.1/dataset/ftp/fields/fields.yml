- default_field: false
  description: |
    Fields exported by the Zeek FTP log
  fields:
  - description: |
      User name for the current FTP session.
    name: user
    type: keyword
  - description: |
      Password for the current FTP session if captured.
    name: password
    type: keyword
  - description: |
      Command given by the client.
    name: command
    type: keyword
  - description: |
      Argument for the command if one is given.
    name: arg
    type: keyword
  - fields:
    - description: |
        Size of the file if the command indicates a file transfer.
      name: size
      type: long
    - description: |
        Sniffed mime type of file.
      name: mime_type
      type: keyword
    - description: |
        (present if base/protocols/ftp/files.bro is loaded)
        File unique ID.
      name: fuid
      type: keyword
    name: file
    type: group
  - fields:
    - description: |
        Reply code from the server in response to the command.
      name: code
      type: integer
    - description: |
        Reply message from the server in response to the command.
      name: msg
      type: keyword
    name: reply
    type: group
  - description: |
      Expected FTP data channel.
    fields:
    - description: |
        Whether PASV mode is toggled for control channel.
      name: passive
      type: boolean
    - description: |
        The host that will be initiating the data connection.
      name: originating_host
      type: ip
    - description: |
        The host that will be accepting the data connection.
      name: response_host
      type: ip
    - description: |
        The port at which the acceptor is listening for the data connection.
      name: response_port
      type: integer
    name: data_channel
    type: group
  - description: |
      Current working directory that this session is in. By making the default value '.', we can indicate that unless something more concrete is discovered that the existing but unknown directory is ok to use.
    name: cwd
    type: keyword
  - description: |
      Command that is currently waiting for a response.
    fields:
    - description: |
        Command.
      name: cmd
      type: keyword
    - description: |
        Argument for the command if one was given.
      name: arg
      type: keyword
    - description: |
        Counter to track how many commands have been executed.
      name: seq
      type: integer
    name: cmdarg
    type: group
  - description: |
      Queue for commands that have been sent but not yet responded to are tracked here.
    name: pending_commands
    type: integer
  - description: |
      Indicates if the session is in active or passive mode.
    name: passive
    type: boolean
  - description: |
      Determines if the password will be captured for this request.
    name: capture_password
    type: boolean
  - description: |
      present if base/protocols/ftp/gridftp.bro is loaded.
      Last authentication/security mechanism that was used.
    name: last_auth_requested
    type: keyword
  name: zeek.ftp
  type: group
